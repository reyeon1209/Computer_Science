## **THEMA 26 스캐닝(Scanning)**

### 1. 스캐닝
- 네트워크 상에서 전문 도구를 이용해 공격대상 네트워크의 상태를 조사하여 정보 수집

### 2. 스캐닝 종류
#### (1) TCP Half-OPEN 스캔
- 포트가 열려있을 경우: RST
- 포트가 닫혀있을 경우: RST + ACK

#### (2) UDP 스캔
- 포트가 열려있을 경우: 응답없음
- 포트가 닫혀있을 경우: ICMP Unreachable 패킷

#### (3) 스텔스 스캔
- 포트가 열려있을 경우: 응답없음
- 포트가 닫혀있을 경우: RST
- 공격대상 시스템의 로그에 기록되지 않는다.
- 방화벽은 통과할 수 있지만 IDS를 완전히 피할 수는 없다.
- 공격대상에게 공격자의 위치를 숨길 수 있다.
- FIN 스캔: TCP FIN 플래그를 설정한 패킷을 공격 대상 시스템에 전송
- X-MAS 스캔: TCP 플래그 값을 모두 설정하거나 일부 값을 설정한 패킷을 공격 대상 시스템에 전송
- Null 스캔: TCP 플래그 값을 설정하지 않은 패킷을 공격 대상 시스템에 전송

#### (4) 단편화 스캔
- TCP 해더를 두 개의 패킷으로 나누어 공격 대상 시스템에 전송
- 첫 번째 패킷에는 출발지 IP주소와 목적지 IP주소를 저장, 두 번째 패킷에는 스캔하고자 하는 포트 번호를 저장하여 전송
- 스캐너와 스캔 대상 시스템 사이에 설치된 방화벽의 종류와 정책을 판단

#### (5) ACK 스캔
- 스캐너와 스캔 대상 시스템 사이에 설치된 방화벽의 종류와 정책을 판단

### nmap (network mapper)
- 스캔 대상 시스템 및 네트워크 영역을 설정한다.
- 열려있는 포트 번호에 대한 목록을 보여준다.
- 열린 포트에 대한 상태 정보(OS 종류, 방화벽 설치 여부)를 보여준다.
- 제공 서비스에 대한 내용을 보여준다.
- 시스템에서 사용하는 MAC 주소에 대한 정보를 보여준다.

### 스캔
- nmap
- fping: 멀티캐스트 방식 ping
- sing

### FTP bounce 공격
- FTP 서버가 데이터를 전송할 때 목적지를 검사하지 않는다는 점을 이용
- 익명 FTP 서버를 경유하여 특정 호스트의 포트를 스캔

### Firewalk
- 방화벽의 ACL(Access Control List)를 알아내는 방법
- 방화벽까지의 TTL보다 1만틈 더 큰 TTL 값을 생성하여 보냄
- 방화벽이 패킷을 차단할 경우, 응답 없음
- 방화벽이 패킷을 전달할 경우, 패킷은 다음 라우터에서 사라지며 ICMP Time Exceeded 메시지를 보낸다.
- 공격자는 ICMP Time Exceeded 메시지를 받은 포트에 대해 열린 포트임을 알 수 있다.

### NetBIOS
- 윈도우에서 시스템 정보 수집, 사용자 목록화, 공유 자원 목록화 등을 수행하기 위해 사용되는 프로토콜




